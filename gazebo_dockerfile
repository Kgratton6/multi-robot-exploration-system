FROM ubuntu:22.04

ENV DEBIAN_FRONTEND=noninteractive
ENV ROS_DOMAIN_ID=102
ENV GZ_VERSION=fortress

RUN apt-get update && apt-get upgrade -y && \
    apt-get install -y \
    lsb-release \
    wget \
    curl \
    gnupg \
    python3-pip \
    git \
    software-properties-common \
    mesa-utils \
    libglu1-mesa-dev \
    freeglut3-dev \
    mesa-common-dev \
    ros-humble-slam-toolbox \
    ros-humble-navigation2 \
    ros-humble-nav2-bringup \
    rviz2 \
    tmux \
    nano
    
RUN pip3 install -U vcstool colcon-common-extensions rosdep

RUN wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg && \
    echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main" > /etc/apt/sources.list.d/gazebo-stable.list && \
    apt-get update && apt-get install -y ignition-fortress
    
    
RUN rosdep init && rosdep update

WORKDIR /root/ws
COPY ./gazebo ./gazebo
COPY ./robot ./robot
COPY ./robot_gazebo_start.sh ./robot_gazebo_start.sh

RUN echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc

ENV DISPLAY=:0

CMD ["bash", "start_project.sh"]



